<!--pages/history/history.wxml-->
<wxs module="m_history">
var getStatusName = function(status) {
    var name = '';
    switch (status) {
        case 0:
            name = '待下发';
            break;
        case 1:
            name = '待接受';
            break;
        case 2:
            name = '待发车';
            break;
        case 3:
            name = '运输中';
            break;
        case 4:
            name = '已送达';
            break;
        case 5:
            name = '已确认送达';
            break;
    }
    return name;
};

module.exports = {
    getStatusName: getStatusName
};
</wxs>
<view class='container'>
    <view class='hasReport' wx:if="{{historys.length}}">
    <view class='top-time'>2018年3月</view>
    <view class='historys'>
        <view class='history' wx:for="{{historys}}" wx:key="{{index}}">
            <navigator  class="weui-btn history-task-btn" url="../detail/detail" hover-class="navigator-hover">
    <view class='h-t'>
                <text class='num'>订单号： {{item.waybillNum}}</text>
                <text class='gray'>({{item.mileage}}M)</text>
                <text class='red fr'>{{m_history.getStatusName(item.status)}}</text>
            </view>
            <view class='h-c'>
                <view class='item' wx:for="{{item.taskDetails}}" wx:for-index="j" wx:for-item="site" wx:key="{{j}}">
                    <text class='time'>{{site.scheduleTime}}</text>
                    <view class='logo-wrap'><image src="{{j === 0 ? '../image/start_city_list.png' : j === item.taskDetails.length - 1 ? '../image/end_city_list.png' : '../image/road_list.png'}}" class="img"></image></view>
                    <text class='address'>{{site.siteName}}</text>
                </view>
            </view>
    </navigator>
            <view class='h-b'>
            <navigator class='navbtn' url="../reportDocument/reportDocument?wayNum={{item.waybillNum}}">
                <view bindtap='reportD' class='btn gray'>单据上报</view>
            </navigator>
                <view bindtap='auditD' class='btn'>单据审批</view>
            </view>
        </view>
    </view>
    </view>
    <view class='noReport' wx:if="{{!historys.length}}">
    <view class='img-wrap'>
        <image src="../image/no_task.png" class="logo"></image>
    </view>
    <view class='tip'>暂无数据</view>
    </view>
</view>
